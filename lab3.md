## การทดลองที่3 เรื่อง การเขียนโปรแกรมoutputสัญญาณดิจิทัล

## วัตถุประสงค์
1. เพื่อศึกษาการเขียนและการรันโปรแกรมจากไมโครคอนโทรลเลอร์ที่ต่อกับ adapter
2. เพื่อศึกษาหน้าที่ของรีเลย์
3. เพื่อศึกษา output ที่แสดงผลออกมา
 
## อุปกรณ์ที่ใช้
1. microcontroller ESP-01 ประกอบด้วย CPU เสาอากาศสำหรับ wifi
2. อุปกรณ์เชื่อมต่อ USB เข้าไปยัง serial
3. relay
4. Adapter
5. หลอดไฟ LED เปล่งแสง

## ศึกษาข้อมูลเบื้องต้น
  https://youtu.be/6JnhaUILGuw
  
  https://youtu.be/CCnN1WJsXQY

## วิธีการทำการทดลอง
1. นำ adapter(ที่ต่อกับLED) ต่อเข้ากับ USB
2. ทำการเสียบ microcontroller เข้าทาง serial port ของ USB
3. ดูที่ตัวอย่างโปรแกรม ที่โฟลเดอร์ PATTANI
  
  • พิมพ์ cd pattani เพื่อไปยังโฟลเดอร์
  
  • แสดงโฟลเดอร์ ซึ่งจะมีโปรแกรมตัวอย่าง 9 โปรแกรม
  
  • ไปที่ตัวอย่างที่ 3
    
    • พิมพ์ cd 03_Output-Port
4. ดู source code program 
  • พิมพ์ vi src/main.cpp
  
  • โปรแกรมนี้ set up serial port ที่ port0 (output)
  
  • ใน loop แสดงให้เห็นถึงการวนไปเรื่อยๆในบรรทัดต่างๆ ประกอบด้วย
  
    • cnt++ หมายถึง การนับเพิ่มเรื่อยๆ หาก cnt%2 แปลว่าตัวเลขเป็นเลขคี่ ให้ดำเนินการon หากไม่ใช่ แปลว่า ตัวเลขเป็นเลขคู่ ให้ดำเนินการoff
    
    • delay(500) หมายถึง ช่วงเวลา 500 ms
5. อัพโหลดโปรแกรม 03_Output-Port เข้าไปยัง Microcontroller โดยใช้คำสั่ง upload
  
  • พิมพ์ pio run -t upload
  
  • ในขณะที่ program กำลังรันข้อมูล เพื่อให้ microcontroller รันโปรแกรมใหม่เข้าไป กดปุ่มสีดำเพื่อให้เกิดการโหลด และกดปุ่มสีแดงเพื่อให้เกิดการรีเซ็ท
  
  • อัพโหลดเข้าตัว microcontroller เสร็จสิ้น
  
  • สังเกตผลลัพธ์ที่แสดงผ่านคอมพิวเตอร์ พิมพ์ pio device monitor 
6. นำ microcontroller ต่อเข้ากับ relay เพื่อให้ relay ทำหน้าที่ปิดเปิดสวิตซ์
7. นำแหล่งจ่ายไฟมาต่อเข้ากับตัว relay เพื่อจ่ายไฟให้กับ relay ผลลัพธ์ออกมาเป็น on off สลับกันไปเรื่อยๆ 
  
  • ไฟสีเขียวติดๆดับๆ สลับกันไป
  
  • ไฟสีน้ำเงินไม่ติด

## การบันทึกผลการทดลอง
 • count เลขคู่ หลอดไฟสีเขียวติด
 
 • count เลขคี่ หลอดไฟสีเขียวไม่ติด
 
## อภิปรายผลการทดลอง
  • pio run -t upload ใช้ในการ upload ข้อมูลจาก 03_Output-Port เข้าไปยัง Microcontroller โดยคำสั่ง pio device monitor ที่ใช้ดูผลลัพธ์ของโปรแกรมที่ถูกอัพโหลดเข้าไป โดย output ที่ได้จะออกมาจะสังเกตว่า ขึ้น on-off สลับกันทุก 500 ms ในขณะเดียวกันหลอดไฟ ที่ port0 ซึ่งติดและดับ ตามคำสั่ง on-off เมื่อนำ microcontroller ต่อเข้ากับ Relay จะเห็นได้ว่า Relay มีลักษณะการเปิดปิดสวิตซ์สอดคล้องกับโค้ดของโปรแกรมที่เราป้อนข้อมูลลงไป

## คำถามหลังการทดลอง 
 คำถาม : คำสั่ง pio run -t upload ทำหน้าที่อะไร ?

 คำตอบ : ใช้ในการ upload ข้อมูลจาก 03_Output-Port เข้าไปยัง Microcontroller 

